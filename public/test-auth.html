<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase èªè­‰æ¸¬è©¦ - ForoPrayo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #FFE5D9;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .warning { color: #ffc107; }
        .info { color: #007bff; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
        button:disabled { background: #6c757d; cursor: not-allowed; }
        input {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>ğŸ”¥ Firebase èªè­‰æ¸¬è©¦</h1>
    
    <div class="test-section">
        <h2>1. Firebase é…ç½®æª¢æŸ¥</h2>
        <button onclick="testFirebaseConfig()">æ¸¬è©¦ Firebase é…ç½®</button>
        <div id="configResult"></div>
    </div>

    <div class="test-section">
        <h2>2. Firebase Auth åˆå§‹åŒ–æª¢æŸ¥</h2>
        <button onclick="testFirebaseAuth()">æ¸¬è©¦ Firebase Auth</button>
        <div id="authResult"></div>
    </div>

    <div class="test-section">
        <h2>3. æ‰‹å‹•ç™»å…¥æ¸¬è©¦</h2>
        <input type="email" id="testEmail" placeholder="æ¸¬è©¦ç”¨é›»å­éƒµä»¶" value="">
        <input type="password" id="testPassword" placeholder="æ¸¬è©¦ç”¨å¯†ç¢¼" value="">
        <button onclick="testSignIn()">æ¸¬è©¦ç™»å…¥</button>
        <button onclick="testSignUp()">æ¸¬è©¦è¨»å†Š</button>
        <div id="loginResult"></div>
    </div>

    <div class="test-section">
        <h2>4. ç•¶å‰èªè­‰ç‹€æ…‹</h2>
        <button onclick="checkAuthState()">æª¢æŸ¥èªè­‰ç‹€æ…‹</button>
        <button onclick="signOutTest()">ç™»å‡º</button>
        <div id="authStateResult"></div>
    </div>

    <script type="module">
        // Firebase é…ç½® (èˆ‡æ‡‰ç”¨ç¨‹å¼ç›¸åŒ)
        const firebaseConfig = {
            apiKey: "AIzaSyBcFamR8al69jVzgia0kxKIcf5inLpxt0I",
            authDomain: "foroprayo.firebaseapp.com",
            projectId: "foroprayo",
            storageBucket: "foroprayo.firebasestorage.app",
            messagingSenderId: "863364228350",
            appId: "1:863364228350:web:9aa4648b3582c8670a71af",
            measurementId: "G-YX85B6N0M8"
        };

        let auth = null;
        let app = null;

        // æ¸¬è©¦ Firebase é…ç½®
        window.testFirebaseConfig = async function() {
            const result = document.getElementById('configResult');
            result.innerHTML = '<p class="info">æ­£åœ¨æ¸¬è©¦ Firebase é…ç½®...</p>';
            
            try {
                // å‹•æ…‹å°å…¥ Firebase SDK
                const { initializeApp } = await import('https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js');
                const { getAuth } = await import('https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js');
                
                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                
                result.innerHTML = `
                    <p class="success">âœ… Firebase é…ç½®æˆåŠŸï¼</p>
                    <pre>${JSON.stringify(firebaseConfig, null, 2)}</pre>
                `;
            } catch (error) {
                result.innerHTML = `
                    <p class="error">âŒ Firebase é…ç½®å¤±æ•—ï¼š${error.message}</p>
                    <pre>${error.stack}</pre>
                `;
            }
        };

        // æ¸¬è©¦ Firebase Auth
        window.testFirebaseAuth = async function() {
            const result = document.getElementById('authResult');
            result.innerHTML = '<p class="info">æ­£åœ¨æ¸¬è©¦ Firebase Auth...</p>';
            
            try {
                if (!auth) {
                    await testFirebaseConfig();
                }
                
                result.innerHTML = `
                    <p class="success">âœ… Firebase Auth åˆå§‹åŒ–æˆåŠŸï¼</p>
                    <p><strong>App Name:</strong> ${auth.app.name}</p>
                    <p><strong>Config:</strong> ${auth.app.options.projectId}</p>
                `;
            } catch (error) {
                result.innerHTML = `
                    <p class="error">âŒ Firebase Auth åˆå§‹åŒ–å¤±æ•—ï¼š${error.message}</p>
                    <pre>${error.stack}</pre>
                `;
            }
        };

        // æ¸¬è©¦ç™»å…¥
        window.testSignIn = async function() {
            const result = document.getElementById('loginResult');
            const email = document.getElementById('testEmail').value;
            const password = document.getElementById('testPassword').value;
            
            if (!email || !password) {
                result.innerHTML = '<p class="warning">âš ï¸ è«‹è¼¸å…¥é›»å­éƒµä»¶å’Œå¯†ç¢¼</p>';
                return;
            }
            
            result.innerHTML = '<p class="info">æ­£åœ¨å˜—è©¦ç™»å…¥...</p>';
            
            try {
                if (!auth) {
                    await testFirebaseAuth();
                }
                
                const { signInWithEmailAndPassword } = await import('https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js');
                const userCredential = await signInWithEmailAndPassword(auth, email, password);
                
                result.innerHTML = `
                    <p class="success">âœ… ç™»å…¥æˆåŠŸï¼</p>
                    <p><strong>User ID:</strong> ${userCredential.user.uid}</p>
                    <p><strong>Email:</strong> ${userCredential.user.email}</p>
                    <p><strong>é¡¯ç¤ºåç¨±:</strong> ${userCredential.user.displayName || 'æœªè¨­å®š'}</p>
                `;
            } catch (error) {
                result.innerHTML = `
                    <p class="error">âŒ ç™»å…¥å¤±æ•—ï¼š${error.message}</p>
                    <p><strong>éŒ¯èª¤ä»£ç¢¼:</strong> ${error.code}</p>
                    <pre>${error.stack}</pre>
                `;
            }
        };

        // æ¸¬è©¦è¨»å†Š
        window.testSignUp = async function() {
            const result = document.getElementById('loginResult');
            const email = document.getElementById('testEmail').value;
            const password = document.getElementById('testPassword').value;
            
            if (!email || !password) {
                result.innerHTML = '<p class="warning">âš ï¸ è«‹è¼¸å…¥é›»å­éƒµä»¶å’Œå¯†ç¢¼</p>';
                return;
            }
            
            result.innerHTML = '<p class="info">æ­£åœ¨å˜—è©¦è¨»å†Š...</p>';
            
            try {
                if (!auth) {
                    await testFirebaseAuth();
                }
                
                const { createUserWithEmailAndPassword } = await import('https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js');
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                
                result.innerHTML = `
                    <p class="success">âœ… è¨»å†ŠæˆåŠŸï¼</p>
                    <p><strong>User ID:</strong> ${userCredential.user.uid}</p>
                    <p><strong>Email:</strong> ${userCredential.user.email}</p>
                `;
            } catch (error) {
                result.innerHTML = `
                    <p class="error">âŒ è¨»å†Šå¤±æ•—ï¼š${error.message}</p>
                    <p><strong>éŒ¯èª¤ä»£ç¢¼:</strong> ${error.code}</p>
                    <pre>${error.stack}</pre>
                `;
            }
        };

        // æª¢æŸ¥èªè­‰ç‹€æ…‹
        window.checkAuthState = async function() {
            const result = document.getElementById('authStateResult');
            result.innerHTML = '<p class="info">æ­£åœ¨æª¢æŸ¥èªè­‰ç‹€æ…‹...</p>';
            
            try {
                if (!auth) {
                    await testFirebaseAuth();
                }
                
                const { onAuthStateChanged } = await import('https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js');
                
                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        result.innerHTML = `
                            <p class="success">âœ… ç”¨æˆ¶å·²ç™»å…¥</p>
                            <p><strong>User ID:</strong> ${user.uid}</p>
                            <p><strong>Email:</strong> ${user.email}</p>
                            <p><strong>é¡¯ç¤ºåç¨±:</strong> ${user.displayName || 'æœªè¨­å®š'}</p>
                            <p><strong>Email é©—è­‰:</strong> ${user.emailVerified ? 'å·²é©—è­‰' : 'æœªé©—è­‰'}</p>
                        `;
                    } else {
                        result.innerHTML = '<p class="warning">âš ï¸ ç”¨æˆ¶æœªç™»å…¥</p>';
                    }
                });
                
                setTimeout(() => {
                    if (result.innerHTML.includes('æ­£åœ¨æª¢æŸ¥')) {
                        result.innerHTML = '<p class="warning">âš ï¸ èªè­‰ç‹€æ…‹æª¢æŸ¥è¶…æ™‚</p>';
                    }
                }, 3000);
                
            } catch (error) {
                result.innerHTML = `
                    <p class="error">âŒ èªè­‰ç‹€æ…‹æª¢æŸ¥å¤±æ•—ï¼š${error.message}</p>
                    <pre>${error.stack}</pre>
                `;
            }
        };

        // ç™»å‡ºæ¸¬è©¦
        window.signOutTest = async function() {
            const result = document.getElementById('authStateResult');
            result.innerHTML = '<p class="info">æ­£åœ¨ç™»å‡º...</p>';
            
            try {
                if (!auth) {
                    await testFirebaseAuth();
                }
                
                const { signOut } = await import('https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js');
                await signOut(auth);
                
                result.innerHTML = '<p class="success">âœ… å·²æˆåŠŸç™»å‡º</p>';
            } catch (error) {
                result.innerHTML = `
                    <p class="error">âŒ ç™»å‡ºå¤±æ•—ï¼š${error.message}</p>
                    <pre>${error.stack}</pre>
                `;
            }
        };

        // é é¢è¼‰å…¥æ™‚è‡ªå‹•æ¸¬è©¦é…ç½®
        window.addEventListener('load', () => {
            testFirebaseConfig();
        });
    </script>
</body>
</html> 